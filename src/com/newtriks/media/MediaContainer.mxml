<?xml version="1.0"?>
<!--
  ~ Copyright (c) 2011 Simon Bailey <simon@newtriks.com>
  ~
  ~ Permission is hereby granted to use, modify, and distribute this file
  ~ in accordance with the terms of the license agreement located at the
  ~ following url: http://www.newtriks.com/LICENSE.html
  -->
<video:VideoContainer xmlns:video="com.newtriks.core.*"
                      xmlns:fx="http://ns.adobe.com/mxml/2009"
                      implements="com.newtriks.core.interfaces.IVideoContainer">
    <fx:Script><![CDATA[
        import com.newtriks.core.VideoConfigurationVO;

        public function get streamName():String
        {
            return video.streamName;
        }

        public function publish():void
        {
            if(!video)
            {
                throw Error("A core object has not been created, check the startup logic");
            }
            MediaBase(video).publish();
        }

        public function unpublish():void
        {
            MediaBase(video).unpublish();
        }

        public function togglePlayback():void
        {
            video.stream.togglePause();
        }

        override public function setup():void
        {
            if(!video)
            {
                video=new MediaBase(new VideoConfigurationVO(baseType)
                        .aspectRatio(aspectRatio).client(client)
                        .layoutCallbackHandler(layoutHandler)
                        .metaDataReceived(metaDataHandler)
                        .logCallbackHandler(logHandler)
                        .quality(quality)
                        .bandwidth(bandwidth)
                        .microphoneRate(microphoneRate)
                        .microphoneSilenceLevel(microphoneSilenceLevel)
                        .fps(fps));
                addElement(video);
            }
            if(video.connection && video.connection.connected) return;
            video.connection=connection;
        }

        public function loadStream(video_url:String):void
        {
            video.streamName=video_url;
        }
        ]]></fx:Script>
</video:VideoContainer>
